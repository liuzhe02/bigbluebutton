#summary Monitoring BigBlueButton with JConsole and/or VisualVM

= Introduction =

In this page, we are going to describe how to monitor !BigBlueButton's performance (memory consumption, CPU usage, threads, etc) using  [http://download.oracle.com/javase/6/docs/technotes/tools/share/jconsole.html  Jconsole] and/or [http://download.oracle.com/javase/6/docs/technotes/guides/visualvm/index.html JVisualVM]. 

Jconsole and VisualVM can put load on your server. It is recommended to connect remotely to your server to have correct results. 

= Details =
=== Generate Keys ===

Go to the Red5 conf directory
{{{
   cd /usr/share/red5/conf
}}}

Generate a keystore. You will be prompted for password and other information. Make note of the password you entered as you'll need them later.
{{{
   sudo keytool -genkey -alias jconsole -keystore red5JConsoleKeyStore
}}}

Check if the keystore has been generated properly.
{{{
   keytool -list -keystore red5JConsoleKeyStore
}}}

Let's export the keystore so we can use it to connect from JConsole or VisualVM
{{{
   sudo keytool -export -alias jconsole -keystore red5JConsoleKeyStore -file jconsole.cert
}}}

Now we copy {{{jconsole.cert}}} into the machine where we will run jconsole or VisualVM. Let's put it into a folder called {{{D:\visualvm}}}.

Import the into a file call {{{red5KeyStore}}}. When prompted for a password, enter the password you used when you created the keystore.
{{{
D:\visualvm>keytool -import -alias red5 -keystore C:\visualvm\red5KeyStore -file jconsole.cert
}}}

{{{
D:\visualvm_122\bin>jconsole -J-Djavax.net.ssl.keyStore="C:\Java\jdk1.6.0_07\bin\red5KeyStore" -J-Djavax.net.ssl.keyStorePassword=password -J-Djavax.net.ssl.trustStore="C:\Java\jdk1.6.0_07\bin\red5KeyStore"

D:\visualvm_122\bin>visualvm -J-Djavax.net.ssl.keyStore="C:\Java\jdk1.6.0_07\bin\red5KeyStore" -J-Djavax.net.ssl.keyStorePassword=password -J-Djavax.net.ssl.trustStore="C:\Java\jdk1.6.0_07\bin\red5KeyStore"
mv jconsole.cert ~/

}}}

Open up {{{/usr/share/red5/conf/red5.properties}}}:
 1. Make note of the value of {{{rtmps.keystorepass}}}, you 
{{{

rtmps.keystorepass=password

# JMX
jmx.rmi.port.registry=9999
jmx.rmi.port.remoteobjects=
jmx.rmi.host=192.168.0.166
jmx.rmi.ssl=true
}}}

/usr/share/red5/conf/password.properties
red5user changeme





/usr/share/red5/conf/conf/red5-common.xml
        <bean id="jmxAgent" class="org.red5.server.jmx.JMXAgent" init-method="init">
                <!-- The RMI adapter allows remote connections to the MBeanServer -->
                <property name="enableRmiAdapter" value="true"/>
                <property name="rmiAdapterPort" value="${jmx.rmi.port.registry}"/>
                <property name="rmiAdapterRemotePort" value="${jmx.rmi.port.remoteobjects}"/>
                <property name="rmiAdapterHost" value="${jmx.rmi.host}"/>
                <property name="enableSsl" value="${jmx.rmi.ssl}"/>
                <!-- Starts a registry if it doesnt exist -->
                <property name="startRegistry" value="true"/>
                <!-- Authentication -->
                <property name="remoteAccessProperties" value="${red5.config_root}/access.properties"/>
                <property name="remotePasswordProperties" value="${red5.config_root}/password.properties"/>
                <property name="remoteSSLKeystore" value="${red5.config_root}/red5JConsoleKeyStore"/>
                <property name="remoteSSLKeystorePass" value="${rtmps.keystorepass}"/>
                <!-- Mina offers its own Mbeans so you may integrate them here -->
                <property name="enableMinaMonitor" value="false"/>
        </bean>^M





}}}

References:
[http://www.red5tutorials.net/index.php/An_idiot's_guide_to_RMI/JMX_remote_connections_-_without_SSL_/_authentication See this link]
[http://www.componative.com/content/controller/developer/insights/jconsole2/index.html in this web page]