#summary How to install BigBlueButton 0.81-dev

<wiki:toc max_depth="3" />

= Before You Install =

*Note:* These instructions are currently for developers only.  If your not a developer working on !BigBlueButton 0.81-dev, we recommend waiting until we announce release of 0.81-beta before doing the steps below.


The requirements are

  * Ubuntu 10.04 32-bit or 64-bit
  * 4 GB of memory (8 GB is better)
  * Quad-core 2.6 GHZ CPU (or faster)
  * Ports 80, 1935, 9123 accessible
  * Port 80 is *not* used by another application
  * 500G of free disk space (or more) for recordings

These instructions assume you do not have a previous version of !BigBlueButton installed.  (The final release of 0.81 will update from 0.80.)

In addition to the above, the locale of the server must be en_US.UTF-8.  You can verify this by

{{{
$ cat /etc/default/locale
LANG="en_US.UTF-8"
}}}

If you don't see `LANG="en_US.UTF-8"`, then do the following

{{{
sudo apt-get install language-pack-en
sudo update-locale LANG=en_US.UTF-8
}}}

and the logout and log back into your session.  After the above, do `cat /etc/default/locale` again and verify you see `LANG="en_US.UTF-8"`.

= Installing !BigBlueButton 0.81 =

If you are upgrading from !BigBlueButton 0.80, start [#Upgrading_from_BigBlueButton_0.80 here].

== 1. Update your server == 

You first need to give your server access to the !BigBlueButton package repository for 0.81.

In a terminal window, copy and paste the following commands.

{{{
# Add the BigBlueButton key
wget http://ubuntu.bigbluebutton.org/bigbluebutton.asc -O- | sudo apt-key add -

# Add the BigBlueButton repository URL and ensure the multiverse is enabled
echo "deb http://ubuntu.bigbluebutton.org/lucid_dev_081/ bigbluebutton-lucid main" | sudo tee /etc/apt/sources.list.d/bigbluebutton.list
echo "deb http://us.archive.ubuntu.com/ubuntu/ lucid multiverse" | sudo tee -a /etc/apt/sources.list

}}}

*Note:* The repository for lucid_dev_081 currently _development_ builds of !BigBlueButton 0.81.  Until there is an announcement in [https://groups.google.com/group/bigbluebutton-dev/topics?gvc=2 bigbluebutton-dev] that !BigBlueButton 0.81-beta, these development packages may periodically break as development proceeds to beta.

After you've made the above changes, do a dist-upgrade to ensure your running the latest packages and your server is up-to-date before installing !BigBlueButton.

{{{
sudo apt-get update
sudo apt-get dist-upgrade

}}}

If you've not updated in a while, apt-get may recommend you reboot your server after `dist-upgrade` finishes.  Do the reboot before proceeding to the next step.

== 2. Install Ruby == 
The record and playback infrastructure uses Ruby for the processing of recorded sessions.  

Check if you have a previous version of ruby install.

{{{
   dpkg -l | grep ruby
}}}

If you already have ruby installed, check it's version

{{{
~$ ruby -v
ruby 1.9.2p290 (2011-07-09 revision 32553)
}}}

If the version of ruby does not match the above, uninstall it before continuing.

Next, you'll need to install the following dependencies to compile ruby.

{{{
sudo apt-get install zlib1g-dev libssl-dev libreadline5-dev libyaml-dev build-essential bison checkinstall libffi5 gcc checkinstall libreadline5 libyaml-0-2

}}}

Next, create a file called `install-ruby.sh` and copy and paste in the following script.

{{{
#!/bin/bash
cd /tmp
wget http://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p290.tar.gz
tar xvzf ruby-1.9.2-p290.tar.gz
cd ruby-1.9.2-p290
./configure --prefix=/usr\
            --program-suffix=1.9.2\
            --with-ruby-version=1.9.2\
            --disable-install-doc
make
sudo checkinstall -D -y\
                  --fstrans=no\
                  --nodoc\
                  --pkgname='ruby1.9.2'\
                  --pkgversion='1.9.2-p290'\
                  --provides='ruby'\
                  --requires='libc6,libffi5,libgdbm3,libncurses5,libreadline5,openssl,libyaml-0-2,zlib1g'\
                  --maintainer=brendan.ribera@gmail.com
sudo update-alternatives --install /usr/bin/ruby ruby /usr/bin/ruby1.9.2 500 \
                         --slave /usr/bin/ri ri /usr/bin/ri1.9.2 \
                         --slave /usr/bin/irb irb /usr/bin/irb1.9.2 \
                         --slave /usr/bin/erb erb /usr/bin/erb1.9.2 \
                         --slave /usr/bin/rdoc rdoc /usr/bin/rdoc1.9.2
sudo update-alternatives --install /usr/bin/gem gem /usr/bin/gem1.9.2 500

}}}

Next, run the script

{{{
chmod +x install-ruby.sh
./install-ruby.sh
}}}

After the install finishes, type `ruby -v`.  You should see the ruby interpreter output `1.9.2p290` (or later). 

{{{
$ ruby -v
ruby 1.9.2p290 (2011-07-09 revision 32553)
}}}

Next type `gem -v`.
{{{
$ gem -v
1.3.7
}}}

Finally, to make sure you can install gems, type `sudo gem install hello` (!BigBlueButton does not need the gem hello; rather, we're just testing to makes sure gem is working properly).

{{{
$ sudo gem install hello
Successfully installed hello-0.0.1
1 gem installed
Installing ri documentation for hello-0.0.1...
Installing RDoc documentation for hello-0.0.1...
}}}

Make sure you can execute the above three commands without errors before continuing with these instructions.  If you do encounter errors, please post to [http://groups.google.com/group/bigbluebutton-setup/topics?gvc=2&pli=1 bigbluebutton-setup] and we'll help you resolve the errors.

You might be wondering why not use the default Ruby packages for Ubumtu 10.04?  Unfortunately, they are out of date.  Thanks to [http://threebrothers.org/brendan/blog/ruby-1-9-2-on-ubuntu-11-04/ Brendan Ribera] for the above script for installing the latest ruby on Ubuntu 10.04 as a package.

== 3.  Install ffmpeg ==
!BigBlueButton uses ffmpeg to process video files for playback.  To install ffmpeg, do the following

{{{
# Install dependencies
sudo apt-get install build-essential git-core checkinstall yasm texi2html libopencore-amrnb-dev libopencore-amrwb-dev libsdl1.2-dev libtheora-dev libvorbis-dev libx11-dev libxfixes-dev libxvidcore-dev zlib1g-dev --yes


# Setup libvpx
if [ ! -d /usr/local/src/libvpx ]; then
  cd /usr/local/src
  sudo git clone http://git.chromium.org/webm/libvpx.git
  cd libvpx
  sudo ./configure
  sudo make
  sudo make install
fi

# Install ffmpeg
cd /usr/local/src
sudo wget http://ffmpeg.org/releases/ffmpeg-0.11.2.tar.gz
sudo tar -xvzf ffmpeg-0.11.2.tar.gz
cd ffmpeg-0.11.2
sudo ./configure  --enable-version3 --enable-postproc  --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libtheora --enable-libvorbis  --enable-libvpx
sudo make
sudo checkinstall --pkgname=ffmpeg --pkgversion="5:$(./version.sh)" --backup=no --deldoc=yes --default
}}}


== 4.  Install !BigBlueButton == 
We're now ready to install !BigblueButton. Type

{{{
   sudo apt-get install bigbluebutton
}}}


This single command is where all the magic happens.  This command installs *all* of !BigBlueButton components with their dependencies.  Here's a screen shot of the packages it will install. 

http://bigbluebutton.googlecode.com/svn/trunk/bbb-images/install_ubuntu_08/apt-get-install.png

Type 'y' and press Enter.  The packaging will do all the work for you to install and configure your !BigBlueButton server.

If you are behind a HTTP Proxy, you will get an error from the package bbb-record-core.  You can resolve this by [#Unable_to_install_gems manually installing the gems].

== 5. Install API Demos ==

To interactively test your !BigBlueButton server, you can install a set of API demos.  

{{{
   sudo apt-get install bbb-demo
}}}

You'll need the bbb-demo package installed if you want to join the Demo Meeting from your !BigBlueButton server's welcome page.  This is the same welcome page you see at [http://demo.bigbluebutton.org our demo server].

Later on, if you wish to remove the API demos, you can enter the command

{{{
   sudo apt-get purge bbb-demo
}}}


== 6. Install record and playback script == 

!BigBlueButton 0.81 has a new playback format that will process all the activity in the presentation area and all the webcams.  To install the new record and playback script, type

{{{
   sudo apt-get install bbb-playback-presentation
}}}


== 7. Do a Clean Restart == 

To ensure !BigBlueButton has started cleanly, enter the following commands:

{{{
   sudo bbb-conf --clean
   sudo bbb-conf --check
}}}

The `--clean` option will clear out all the log files for !BigBlueButton.  The `--check` option will grep through the log files looking for errors.  

The output from `sudo bbb-conf --check` will display your current settings and, after the text, "** Potential problems described below **", print any potential configuration or startup problems it has detected. 




= Upgrading from !BigBlueButton 0.80 =

The following steps will update a !BigBlueButton 0.80 server to 0.81.

== 1. Update your server ==

First, update the package URL to point to the new !BigBlueButton release.

{{{
   echo "deb http://ubuntu.bigbluebutton.org/lucid_dev_081/ bigbluebutton-lucid main" | sudo tee /etc/apt/sources.list.d/bigbluebutton.list
}}}

Next, update the package database on your server.

{{{
   sudo apt-get update
}}}


== 2. Update red5 ==

You must update red5 first before the other !BigBlueButton packages. To update red5, do the following:

{{{
   sudo /etc/init.d/red5 stop
   sudo apt-get install red5
}}}

 
== 3.  Install ffmpeg ==
!BigBlueButton uses ffmpeg to process video files for playback.  To install ffmpeg, do the following

{{{
# Install dependencies
sudo apt-get install build-essential git-core checkinstall yasm texi2html libopencore-amrnb-dev libopencore-amrwb-dev libsdl1.2-dev libtheora-dev libvorbis-dev libx11-dev libxfixes-dev libxvidcore-dev zlib1g-dev --yes


# Setup libvpx
if [ ! -d /usr/local/src/libvpx ]; then
  cd /usr/local/src
  sudo git clone http://git.chromium.org/webm/libvpx.git
  cd libvpx
  sudo ./configure
  sudo make
  sudo make install
fi

# Install ffmpeg
cd /usr/local/src
sudo wget http://ffmpeg.org/releases/ffmpeg-0.11.2.tar.gz
sudo tar -xvzf ffmpeg-0.11.2.tar.gz
cd ffmpeg-0.11.2
sudo ./configure  --enable-version3 --enable-postproc  --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libtheora --enable-libvorbis  --enable-libvpx
sudo make
sudo checkinstall --pkgname=ffmpeg --pkgversion="5:$(./version.sh)" --backup=no --deldoc=yes --default
}}}


== 4. Update !BigBlueButton ==

Next, update !BigBlueButton itself

{{{
   sudo apt-get dist-upgrade
}}}

After the update, make sure everything updated by cleaning out all the old log files, then using the !BigBlueButton configuration utility to check for any installation errors.

{{{
   sudo bbb-conf --clean 
   sudo bbb-conf --check 
}}}
 