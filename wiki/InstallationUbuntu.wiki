#summary How to install  BigBlueButton 0.71a on Ubuntu in under 15 minutes

<wiki:toc max_depth="3" />

= Prerequisites =

This document contains instructions for installing/upgrading *!BigBlueButton 0.71a* on a Ubuntu 10.04 32-bit or 64-bit server (earlier or later versions of Ubuntu are not supported).  If you want to upgrade from !BigBlueButton 0.70, please see the section [#Upgrading_to_BigBlueButton_0.71a Upgrading] later in this document.


Before you install !BigBlueButton 0.71a, you'll need:
  # *An Ubuntu 10.04 32-bit or 64-bit server*
  # *2 GB of memory *
  # Root access to the server
  # 5G of free disk space
  # Port 80 is not in use by other applications

Note: !BigBlueButton uses nginx, which listens on port 80 for http access and tunneling.  If you have apache already running on your server, then you'll need to configure apache to listen on a different port.  To do this, edit `/etc/apache2/ports.conf` and change the entry for 80 to another number, such as 8081.  Avoid using 8080 in apache as !BigBlueButton uses tomcat6 which binds to that port.  

We recommend you install !BigBlueButton on a dedicated server.

= Installation of !BigBlueButton 0.71a =

== 1. Install the !BigBlueButton apt-get repository key  == 

First, install the !BigBlueButton apt-get repository key and URL (*note:* The URL has changed from 0.70).

{{{
   # Install the package key
   wget http://ubuntu.bigbluebutton.org/bigbluebutton.asc -O- | sudo apt-key add -

   # Add the BigBlueButton repository URL and ensure the multiverse is enabled
   # is enabled
   echo "deb http://ubuntu.bigbluebutton.org/lucid/ bigbluebutton-lucid main" | sudo tee /etc/apt/sources.list.d/bigbluebutton.list
   echo "deb http://us.archive.ubuntu.com/ubuntu/ lucid multiverse" | sudo tee -a /etc/apt/sources.list
}}}

== 2. Install a Voice Conference Server == 

!BigBlueButton now lets you choose to use either Asterisk or FreeSWITCH for voice conferencing.  We provide configuration packages for both, so it's easy to install either one.  We recommend FreeSWITCH.

To install FreeSWITCH:
{{{
  sudo apt-get install python-software-properties 
  sudo add-apt-repository ppa:freeswitch-drivers/freeswitch-nightly-drivers
  sudo apt-get update
  sudo apt-get install bbb-freeswitch-config
}}}

Or, instead, to install Asterisk (*WARNING: Do not install both*):
{{{
   sudo apt-get update 
   sudo apt-get install bbb-voice-conference

}}}

Again, install only one of the above

== 3. Install !BigBlueButton == 

We're now ready to install !BigBlueButton.  Type:

{{{
   sudo apt-get install bigbluebutton
}}}

This single command is where all the magic happens.  This command will install *all* of !BigBlueButton components with with their dependencies.  Here's a screen shot of the packages it will install. 

http://bigbluebutton.googlecode.com/svn/trunk/bbb-images/vm/71apt-get.png

Type 'y' and press Enter.  Then sit back.  After a few moments, if you don't have mysql installed, the mysql package script will ask to specify a password for the mysql 'root' user.

http://bigbluebutton.googlecode.com/svn/trunk/bbb-images/vm/mysql.png

Enter a password for mysql's 'root' user (you'll need to enter it twice).  Almost immediately, the package script for bbb-web will prompt you for that mysql root password (shown below).  !BigBlueButton needs to access the mysql to create a database.  Enter the the same password your did a moment ago for mysql.

Note: The mysql password should not contain the following characters as `! # [ ^ $ ] ( )` as they will cause the bbb-web install script to break.

http://bigbluebutton.googlecode.com/svn/trunk/bbb-images/vm/71web.png


== 4. Do a Clean Restart == 

To ensure !BigBlueButton has started cleanly, enter the following commands:

{{{
   sudo bbb-conf --clean
   sudo bbb-conf --check
}}}

The output from `sudo bbb-conf --check` will display your current settings and, after the text, "** Potential problems described below **", print any configuration or startup problems it has detected.  Normally, there is no text following this message.

== Trying out your server (14:42 minutes later) ==

You've got a full !BigBlueButton server up and running (don't you just love the power of Ubuntu/Debian packages). Open a web browser to the URL of your server.  You should see the !BigBlueButton welcome screen.

http://bigbluebutton.googlecode.com/svn/trunk/bbb-images/vm/71welcome.png

To start using your !BigBlueButton server, enter your name and click the 'Join' button.  You'll join the Demo Meeting.

http://bigbluebutton.googlecode.com/svn/trunk/bbb-images/vm/07bbb.png

If this is your first time using !BigBlueButton, take a moment and watch these [http://bigbluebutton.org/content/videos overview videos].  

Also check out our [http://code.google.com/p/bigbluebutton/wiki/FAQ Frequently Asked Questions.]  For example, a common question is  [http://code.google.com/p/bigbluebutton/wiki/FAQ#Can_I_run_multiple_virtual_classrooms_in_a_single_BigBlueButton How do I setup multiple virtual classrooms?]

= Upgrading to !BigBlueButton 0.71a =

If you are running !BigBlueButton 0.70 or 0.71 on Ubuntu 10.04 32-bit or 64-bit, you can upgrade your server by entering the following commands.

First, change the URL for the !BigBlueButton apt-get repository.

{{{
  echo "deb http://ubuntu.bigbluebutton.org/lucid/ bigbluebutton-lucid main" | sudo tee /etc/apt/sources.list.d/bigbluebutton.list
}}}

Next, update your packages

{{{
  sudo /etc/init.d/red5 stop
  sudo apt-get update
  sudo apt-get dist-upgrade
}}}

Finally, do a clean restart of your !BigBlueButton server and use `bbb-conf` to check that everything is running smoothly.

{{{
  sudo bbb-conf --clean
  sudo bbb-conf --check
}}}

You should now be running 0.71a.  

= Switching between Asterisk and FreeSWITCH ==
The !BigBlueButton packages let you switch back and forth between using Asterisk and FreeSWITCH.

To switch from FreeSWITCH to Asterisk, do 

{{{
   sudo apt-get purge bbb-freeswitch-config 
   sudo apt-get purge freeswitch 
   sudo apt-get install bbb-voice-conference 
   sudo bbb-conf --clean 
}}}


To switch from Asterisk to FreeSWTICH, do 

{{{
   sudo apt-get purge bbb-voice-conference 
   sudo apt-get purge asterisk 
   sudo apt-get install bbb-freeswitch-config 
   sudo bbb-conf --clean 
}}}

Note: When you switch back to FreeSWITCH, it seems the FreeSWITCH package will not re-install the sounds.  To install them manually, do the following command:

{{{
   sudo dpkg -i /var/cache/apt/archives/freeswitch-sounds-music-16000*
}}}


= Troubleshooting =

== I'm running !BigBlueButton 0.70 on Ubuntu 9.04 ==

!BigBlueButton 0.71a requires Ubuntu 10.04 (32-bit or 64-bit).  First upgrade your server to 10.04 before installing 0.71a.

== Some dependencies are not met ==

For some VPS installations of Ubuntu 10.04, the hosting provider does not give a full `/etc/apt/source.list`.  If you are finding your are unable to install a package, try replacing your `/etc/apt/sources.list` with the following


{{{
#
#
# deb cdrom:[Ubuntu-Server 10.04 LTS _Lucid Lynx_ - Release amd64 (20100427)]/ lucid main restricted

# deb cdrom:[Ubuntu-Server 10.04 LTS _Lucid Lynx_ - Release amd64 (20100427)]/ lucid main restricted
# See http://help.ubuntu.com/community/UpgradeNotes for how to upgrade to
# newer versions of the distribution.

deb http://us.archive.ubuntu.com/ubuntu/ lucid main restricted
deb-src http://us.archive.ubuntu.com/ubuntu/ lucid main restricted

## Major bug fix updates produced after the final release of the
## distribution.
deb http://us.archive.ubuntu.com/ubuntu/ lucid-updates main restricted
deb-src http://us.archive.ubuntu.com/ubuntu/ lucid-updates main restricted

## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu
## team. Also, please note that software in universe WILL NOT receive any
## review or updates from the Ubuntu security team.
deb http://us.archive.ubuntu.com/ubuntu/ lucid universe
deb-src http://us.archive.ubuntu.com/ubuntu/ lucid universe
deb http://us.archive.ubuntu.com/ubuntu/ lucid-updates universe
deb-src http://us.archive.ubuntu.com/ubuntu/ lucid-updates universe

## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu
## team, and may not be under a free licence. Please satisfy yourself as to
## your rights to use the software. Also, please note that software in
## multiverse WILL NOT receive any review or updates from the Ubuntu
## security team.
deb http://us.archive.ubuntu.com/ubuntu/ lucid multiverse
deb-src http://us.archive.ubuntu.com/ubuntu/ lucid multiverse
deb http://us.archive.ubuntu.com/ubuntu/ lucid-updates multiverse
deb-src http://us.archive.ubuntu.com/ubuntu/ lucid-updates multiverse

## Uncomment the following two lines to add software from the 'backports'
## repository.
## N.B. software from this repository may not have been tested as
## extensively as that contained in the main release, although it includes
## newer versions of some applications which may provide useful features.
## Also, please note that software in backports WILL NOT receive any review
## or updates from the Ubuntu security team.
# deb http://us.archive.ubuntu.com/ubuntu/ lucid-backports main restricted universe multiverse
# deb-src http://us.archive.ubuntu.com/ubuntu/ lucid-backports main restricted universe multiverse

## Uncomment the following two lines to add software from Canonical's
## 'partner' repository.
## This software is not part of Ubuntu, but is offered by Canonical and the
## respective vendors as a service to Ubuntu users.
# deb http://archive.canonical.com/ubuntu lucid partner
# deb-src http://archive.canonical.com/ubuntu lucid partner

deb http://security.ubuntu.com/ubuntu lucid-security main restricted
deb-src http://security.ubuntu.com/ubuntu lucid-security main restricted
deb http://security.ubuntu.com/ubuntu lucid-security universe
deb-src http://security.ubuntu.com/ubuntu lucid-security universe
deb http://security.ubuntu.com/ubuntu lucid-security multiverse
deb-src http://security.ubuntu.com/ubuntu lucid-security multiverse
}}}

then do

{{{ 
   sudo apt-get update
}}}

and try installing !BigBlueButton again.

== Run bbb-conf ==
We've built in a !BigBlueButton configuration utility, called `bbb-conf`, to help you configure your !BigBlueButton server and trouble shoot your setup if something doesn't work right.

If you think something isn't working correctly, the first step is enter the following command.

{{{
   bbb-conf --check
}}}

This will check your setup to ensure the correct processes are running, the !BigBlueButton components have correctly started, and look for common configuration problems that might prevent !BigBlueButton from working properly.  For example, here's the output on one of our internal servers:

http://bigbluebutton.googlecode.com/svn/trunk/bbb-images/vm/71check.png


If you see text after the line `** Potential problems descirbe below **`, then `bbb-conf` detected something wrong with your setup.

== Changing your !BigBlueButton server's hostname (or IP address) ==

A common problem is the address in !BigBlueButton's configuration files is different than the IP address of the host server.  To change all of !BigBlueButton's configuration files to use a different IP address, enter

{{{
   bbb-conf --setip <ip_address>
}}}



== Errors in shutting down red5 ==

The red5 server will start without issues, but on occasion it will throw an exception when shutting down.

{{{

Doing a clean restart of BigBlueButton ...
 * Stopping Red5 Server red5
   Waiting for BigBlueButton to finish starting up before shutting down: .
Running on  Linux
Starting Red5
Attempting to connect to RMI port: 9999
Red5 Tomcat loader was found
Calling shutdown
java.util.ConcurrentModificationException
        at java.util.HashMap$HashIterator.nextEntry(HashMap.java:810)
        at java.util.HashMap$EntryIterator.next(HashMap.java:851)
        at java.util.HashMap$EntryIterator.next(HashMap.java:849)
        at java.util.HashMap.putAllForCreate(HashMap.java:452)
        at java.util.HashMap.clone(HashMap.java:686)
        at org.apache.catalina.loader.WebappClassLoader.clearReferencesStaticFinal(WebappClassLoader.java:1799)
        at org.apache.catalina.loader.WebappClassLoader.clearReferences(WebappClassLoader.java:1718)
        at org.apache.catalina.loader.WebappClassLoader.stop(WebappClassLoader.java:1622)
}}}

You can ignore this error as the `/etc/init.d/red5` script will automatically kill the red5 process if this occurs.

== Getting Help ==

If you have any problems not answered by this document, or you have questions/feedback/bugs, please post to [http://groups.google.com/group/bigbluebutton-setup/topics?gvc=2 bigbluebutton-setup].